<html>
<!-- The license of this page is Apache License 2.0 (http://www.apache.org/licenses/LICENSE-2.0) -->
<head>
	<title>Telegram Bot Messenger</title>
	<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<style type='text/css'>
		body {
			font-family: 'Roboto', sans-serif;
			margin: 40px auto;
			max-width: 900px;
			line-height: 1.4;
			font-size: 16px;
			color: #444;
			padding: 0 10px;
		}
		h1, h2, h3 {
			font-family: 'Roboto', sans-serif;
			line-height: 1.2;
		}
		a {
			color: #444;
		}
		a:hover {
			color: #000;
		}
	</style>
</head>
<body>
	<h1>Telegram Bot Messenger</h1>
	<p>This page will allow you to send a message to a user/group through a Telegram bot. Just enter your bot token from <a href='https://telegram.me/botfather'>BotFather</a> and press 'Send Message'.</p>
	<p>Based on <a href='https://github.com/nadam/playground'>@nadam's Bot API Playground</a>, this page is aimed at users who have little programming experience, if any.</p>
	<p>The source code of this website is also <a href='https://github.com/matthewhesketh/playground'>available on Github</a>.</p><br>
	<label for='token'>Bot token<br></label>
	<input id='token' type='text' /><br><br>
	<label for='message'>Message<br></label>
	<input id='message' type='text' maxlength='4096'/><br><br>
	<label for='chat'>Numerical User/Group ID<br></label>
	<input id='chat' type='text' /><br><br>
	<button id='sendMessage' type='button' onclick='sendMessage()'>Send</button><br><br>
	<p id='output'></p>
	<script>
		var onUpdate = document.getElementById('onUpdate');
		var sendMessage = document.getElementById('sendMessage');
		var running = false;
		var botUrl;
		var xhr;
		function sendMessage() {
			var token = document.getElementById('token').value;
			var message = document.getElementById('message').value;
			var chat = document.getElementById('chat').value;
			botUrl = 'https://api.telegram.org/bot' + token + '/';
			call('sendMessage', {
				chat_id: chat,
				text: message,
			});
		}
		function call(method, params, onResponse, onError, timeout) {
			xhr = new XMLHttpRequest();
			xhr.open('POST', botUrl + method);
			xhr.setRequestHeader('Content-type', 'application/json');
			xhr.onload = function () {
				if (xhr.responseText) {
					var response = JSON.parse(xhr.responseText);
					if (response.result) {
						if (onResponse) {
							onResponse(response.result);
						}
					} else {
						onError(response.error_code, method + ': ' + response.description);
					}
				}
			};
			xhr.onerror = function(e) {
				if (e) {
					onError(-1, e);
				} else {
					onError(-1, 'No connection');
				}
			};
			xhr.timeout = timeout ? timeout * 1000 : 15000;
			xhr.ontimeout = function() {
				onError(-1, 'Timeout');
			};
			xhr.send(JSON.stringify(params));
		}
		function toJson(object) {
			return JSON.stringify(object, undefined, 2);
		}
	</script>
</body>
</html>
